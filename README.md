# Генератор текстов
В качестве основы генератора были взяты: N-граммная модель, случайный лесс, предсказывающий тэг следующего слова, и ансамбль случайного леса, алгоритма k-ближайших соседей и логистической регрессии, объединённых с помощью стэкинга. 
## Инструкция по применению 
- Скачайте и распакуйте в папку data <a href="http://vectors.nlpl.eu/repository/20/180.zip">архив</a>. Он нужен для работы POS-тэгера.
- Убедитесь, что у вас установлены все нужные зависимости.
- Запустите train.py. В папке data/texts находятся тексты, на которых тестировалась модель. Также в папке data находятся два csv файла. Они нужны для обучения двух классификаторов, описанных выше. В случае потери файлов модель может их восстановить, но этой займет примерно 10 минут. Время работы train.py в среднем занимает +- 2 минуты, результирующая модель, обученная на приложенных текстах, весит около 1.5 гигабайт.
- Запустите generate.py. 
## Режим advance
В качестве консольного аргумента generate.py также принимает флаг advance. Если вы хотите генерировать текст с использованием предсказания pos-тэгов следующего слова - передайте 1, иначе 0. Значение по умолчанию - 0
## Необходимые зависимости 
- Pandas, numpy, sklearn.
- pymorphy2, gensim >= 4.2.0 - необходимы для генерации POS-тэгов. В качестве основы был взят этот<a href="https://github.com/ivan-chai/pyfillet">репозиторий</a>.
## Немного про ML-составляющую 
После проведения EDA в обоих случаях было принято использовать в качестве метрики f1_score, так как классы были несбалансированны. При построении первой модели я решал задачу классификации на 4 класса: существительные, глаголы, прилагательные и другие. Во втором случае  предсказывал (".", "!", "?").
## Потенциал развития
- В дальнейшем можно улучшить качество первой модели, поменяв суть задачи, так как градиентный бустинг и стэкинг различных алгоритмов не дали явного прироста качества. 
- Добавить фильтр стоп-слов.
- Добиться уменьшения модели с помощью различных алгоритмов сжатия.
- Добавить обработку запятых, чтобы в конченом тексте они смотрелись уместно.
- Добавить больше проверок входных данных, полученных из консоли.
- Добавить поддержку телеграм бота.
